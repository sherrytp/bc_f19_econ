fig2 <- ggplot(table2, aes(round, y, group = treatment)) + geom_line(color = "grey") + geom_point(alpha = 0.75, aes(shape = treatment))
fig2
pic2 <- df_narrow %>%
select(treatment, round, investment) %>%
filter(treatment == c("individuals", "pay-comm", "message")) %>%
group_by(treatment, round) %>%
summarise(y = mean(investment, na.rm = TRUE)) %>%
ggplot(., aes(round, y)) +
geom_line(aes(group = treatment), color = "grey") +
geom_point(alpha=0.75, aes(shape = treatment)) +
labs(size = "Round") +
theme_classic()
pic2
fig3 <- df_narrow %>%
select(treatment, round, investment) %>%
filter(treatment == c("individuals", "mixed")) %>%
group_by(round, treatment) %>%
summarise(y = mean(investment)) %>%
ggplot(., aes(round, y)) +
geom_line(aes(group = treatment), color = "grey") +
geom_point(alpha=0.75, aes(shape = treatment)) +
labs(size = "Round") +
theme_classic()
fig3
rm(table1, table2.1, table2.2, table2.3, table2, table3)
plot_grid(fig1, fig2, fig3,
labels = c('a', 'b', 'c'),
nrow = 1)
df_team_avg <- df_narrow %>%
group_by(treatment, uniqueteam) %>%
summarise(mean(investment))
# should be get 99 rows
df_narrow %>%
group_by(uniqueteam) %>%
summarise(mean(investment))
x_idv <- table1$y[which(table1$treatment == "individual")]
y_team <- table1$y[which(table1$treatment == "teams")]2
View(pic1)
pic1
rm(list = ls()) # Clear environment
library(tidyverse)
library(cowplot)
library(sandwich)
library(lmtest)
df <- read_csv("sutterexperiment.csv")
old.names <- colnames(df)
new.names <- tolower(old.names)
colnames(df) <- new.names
rm(new.names, old.names)
df$treatment <- tolower(df$treatment)
df <- df %>%
mutate(uniquesubject = paste(session, treatment, subject, sep = "_"))
df <- df %>%
mutate(uniqueteam = paste(session, team, sep = "_"))
df <- df %>% mutate(uniqueteam = ifelse(treatment == "individuals", uniquesubject, uniqueteam))
df_narrow <- df %>%
gather("round", "investment", -c(session, subject, treatment, team, uniquesubject, uniqueteam)) %>%
arrange(session, subject, treatment, team)
# df %>% gather("key", "value", x, y, z) is equivalent to df %>% pivot_longer(c(x, y, z), names_to = "key", values_to = "value")
#df_narrow <- read_csv("sutterexperiment_long.csv")
df_narrow$round <- gsub("r", "", df_narrow$round)
df_narrow %>%
group_by(treatment) %>%
select(investment) %>%
summarise_all(funs(mean, sd))
df_narrow %>%
group_by(treatment) %>%
ggplot(., aes(treatment, investment)) +
stat_summary(fun.y = mean, geom = "bar", fill="grey") +
stat_summary(fun.data = mean_se, geom = "errorbar", width=0.1) +
labs(y = "mean and standard error", x = "Treatment", title = "Mean and Error Bars of Each Treatment") +
theme_classic()
#table1 <- df_narrow %>%  filter(treatment == c("individuals", "teams"))%>%  group_by(round, treatment) %>%  summarise(y = mean(investment))
#fig1 <- ggplot(table1, aes(round, y, group = treatment)) + geom_line(color = "grey") + geom_point(alpha = 0.75, aes(shape = treatment))
fig1 <- df_narrow %>%
select(treatment, round, investment) %>%
filter(treatment == c("individuals", "teams")) %>%
group_by(round, treatment) %>%
summarise(y = mean(investment)) %>%
ggplot(., aes(round, y)) +
geom_line(aes(group = treatment), color = "grey") +
geom_point(alpha=0.75, aes(shape = treatment)) +
labs(size = "Round") +
theme_classic()
fig1
table2.1 <- df_narrow %>%
filter(treatment == "individuals") %>%
group_by(round, treatment) %>%
summarise(y = mean(investment))
table2.2 <- df_narrow %>%
filter(treatment == "pay-comm") %>%
group_by(round, treatment) %>%
summarise(y = mean(investment))
table2.3 <- df_narrow %>%
filter(treatment == "message") %>%
group_by(round, treatment) %>%
summarise(y = mean(investment))
table2 <- rbind(table2.1, table2.2)
table2 <- rbind(table2, table2.3)
fig2 <- ggplot(table2, aes(round, y, group = treatment)) + geom_line(color = "grey") + geom_point(alpha = 0.75, aes(shape = treatment))
fig2
pic2 <- df_narrow %>%
select(treatment, round, investment) %>%
filter(treatment == c("individuals", "pay-comm", "message")) %>%
group_by(treatment, round) %>%
summarise(y = mean(investment, na.rm = TRUE)) %>%
ggplot(., aes(round, y)) +
geom_line(aes(group = treatment), color = "grey") +
geom_point(alpha=0.75, aes(shape = treatment)) +
labs(size = "Round") +
theme_classic()
pic2
fig3 <- df_narrow %>%
select(treatment, round, investment) %>%
filter(treatment == c("individuals", "mixed")) %>%
group_by(round, treatment) %>%
summarise(y = mean(investment)) %>%
ggplot(., aes(round, y)) +
geom_line(aes(group = treatment), color = "grey") +
geom_point(alpha=0.75, aes(shape = treatment)) +
labs(size = "Round") +
theme_classic()
fig3
rm(table1, table2.1, table2.2, table2.3, table2, table3)
plot_grid(fig1, fig2, fig3,
labels = c('a', 'b', 'c'),
nrow = 1)
df_team_avg <- df_narrow %>%
group_by(treatment, uniqueteam) %>%
summarise(mean(investment))
# should be get 99 rows
df_narrow %>%
group_by(uniqueteam) %>%
summarise(mean(investment))
View(df_team_avg)
View(df_team_avg)
df_team_avg %>%
subset(treatment == c("individuals", "teams")) %>%
summarise(x = mean(investment)) %>%
#wilcox.test(y_team, x_idv, var.equal=F, paired = F)
df_team_avg %>%
subset(treatment == c("individuals", "teams")) %>%
summarise(x = mean(investment)) %>%
#wilcox.test(y_team, x_idv, var.equal=F, paired = F)
df_team_avg %>%
subset(treatment == c("individuals", "teams")) %>%
summarise(x = mean(investment))
View(df_team_avg)
df_team_avg %>%
subset(treatment == c("individuals", "teams"))
df_team_avg %>%
group_by(treatment == c("individuals", "teams"))
df_team_avg %>%
group_by(treatment == c("individuals", "teams"))
df_team_avg %>%
subset(treatment == c("individuals", "teams"))
df_team_avg %>%
subset(treatment == c("individuals", "teams")) %>% wilcox.test(var.equal=F, paired = F)
df_team_avg %>%
x <- subset(treatment == "individuals") %>%
y <- subset(treatment == "teams") %>%
wilcox.test(x, y, var.equal=F, paired = F)
df_team_avg %>%
x <- subset(treatment == "individuals") %>%
y <- subset(treatment == "teams")
View(df_team_avg)
sessionInfo()
pandoc_version()
pandoc_available(version = NULL, error = FALSE)
library(rmarkdown)
pandoc_version()
rmarkdown?
rmarkdown?
d
?rmarkdown
?`rmarkdown-package`
rmarkdown_version()
sessionInfo()
?rmarkdown_format
ppl <- subset(df_team_avg$treatment == "individuals") %>%
team <- subset(df_team_avg$treatment == "teams")
View(df_team_avg)
ppl <- df_team_avg$`mean(investment)`[which(df_team_avg == "individuals")]
team <- df_team_avg$`mean(investment)`[which(df_team_avg == "teams")]
wilcox.test(ppl, team, var.equal=F, paired = F)
plot(ppl)
pay <- df_team_avg$`mean(investment)`[which(df_team_avg == "pay-comm")]
mes <- df_team_avg$`mean(investment)`[which(df_team_avg == "message")]
wilcox.test(ppl, pay, var.equal = F, paired = F)
wilcox.test(pay, mes, var.equal = F, paired = F)
wilcox.test(team, mes, var.equal = F, paired = F)
wilcox.test(team, pay, var.equal = F, paired = F)   # get 0.1 but should be > 0.3
wilcox.test(ppl, team, var.equal=F, paired = F)
wilcox.test(ppl, pay, var.equal = F, paired = F)
wilcox.test(pay, mes, var.equal = F, paired = F)
wilcox.test(team, mes, var.equal = F, paired = F)
wilcox.test(team, pay, var.equal = F, paired = F)
library(dummies)
install.packages("dummies")
library(dummies)
df_narrow %>%
dummy(treatment, sep = "_") %>%
m <- lm(decision ~ treatment, data = df_team_avg)
df_narrow %>%
dummy(treatment, sep = "_")
df_narrow <- cbind(df_narrow, dummy(df_narrow$year, sep = "_"))
df_narrow <- cbind(df_narrow, dummy(df_narrow$treatment, sep = "_"))
View(df_narrow)
View(df_narrow)
m <- lm(investment ~ df_narrow_teams+df_narrow_pay-comm+df_narrow_message+df_narrow_mixed, data = df_narrow)
View(df_narrow)
colnames(df_narrow)
m <- lm(investment ~ df_narrow_teams+"df_narrow_pay-comm"+df_narrow_message+df_narrow_mixed, data = df_narrow)
library(readxl)
School <- read_excel("~/Applications/OneDrive/Orientation data 2019.xlsx",
sheet = "School")
View(School)
plot(School)
School$Registered
# Grouped
value <- School$Registered
ggplot(School, aes(fill=Registered, y=value, x=School)) +
geom_bar(position="dodge", stat="identity")
library(ggplot2)
# Grouped
value <- School$Registered
ggplot(School, aes(fill=Registered, y=value, x=School)) +
geom_bar(position="dodge", stat="identity")
ggplot(School, aes(fill=Attend, y=value, x=School)) +
geom_bar(position="dodge", stat="identity")
# Grouped
value <- School$Registered
ggplot(School, aes(fill=Attend, y=value, x=School)) +
geom_bar(position="dodge", stat="identity")
# Grouped
value <- School$Registered
ggplot(School, aes(fill=attend, y=value, x=School)) +
geom_bar(position="dodge", stat="identity")
# Grouped
value <- School$attend
ggplot(School, aes(y=value, x=School)) +
geom_bar(position="dodge", stat="identity")
# Grouped
value <- School$Registered
ggplot(School, aes(y=value, x=School)) +
geom_bar(position="dodge", stat="identity")
# Grouped
value <- School$Registered
ggplot(School, aes(fill=condition, y=value, x=School)) +
geom_bar(position="dodge", stat="identity")
rm(list = ls()) # Clear environment
library(tidyverse)
library(cowplot)
library(sandwich)
library(lmtest)
df <- read_csv("sutterexperiment.csv")
old.names <- colnames(df)
new.names <- tolower(old.names)
colnames(df) <- new.names
rm(new.names, old.names)
df$treatment <- tolower(df$treatment)
df <- df %>%
mutate(uniquesubject = paste(session, treatment, subject, sep = "_"))
df <- df %>%
mutate(uniqueteam = paste(session, team, sep = "_"))
df <- df %>% mutate(uniqueteam = ifelse(treatment == "individuals", uniquesubject, uniqueteam))
df_narrow <- df %>%
gather("round", "investment", -c(session, subject, treatment, team, uniquesubject, uniqueteam)) %>%
arrange(session, subject, treatment, team)
# df %>% gather("key", "value", x, y, z) is equivalent to df %>% pivot_longer(c(x, y, z), names_to = "key", values_to = "value")
#df_narrow <- read_csv("sutterexperiment_long.csv")
df_narrow$round <- gsub("r", "", df_narrow$round)
df_narrow %>%
group_by(treatment) %>%
select(investment) %>%
summarise_all(funs(mean, sd))
df_narrow %>%
group_by(treatment) %>%
ggplot(., aes(treatment, investment)) +
stat_summary(fun.y = mean, geom = "bar", fill="grey") +
stat_summary(fun.data = mean_se, geom = "errorbar", width=0.1) +
labs(y = "mean and standard error", x = "Treatment", title = "Mean and Error Bars of Each Treatment") +
theme_classic()
#table1 <- df_narrow %>%  filter(treatment == c("individuals", "teams"))%>%  group_by(round, treatment) %>%  summarise(y = mean(investment))
#fig1 <- ggplot(table1, aes(round, y, group = treatment)) + geom_line(color = "grey") + geom_point(alpha = 0.75, aes(shape = treatment))
fig1 <- df_narrow %>%
select(treatment, round, investment) %>%
filter(treatment == c("individuals", "teams")) %>%
group_by(round, treatment) %>%
summarise(y = mean(investment)) %>%
ggplot(., aes(round, y)) +
geom_line(aes(group = treatment), color = "grey") +
geom_point(alpha=0.75, aes(shape = treatment)) +
labs(size = "Round") +
theme_classic()
fig1
table2.1 <- df_narrow %>%
filter(treatment == "individuals") %>%
group_by(round, treatment) %>%
summarise(y = mean(investment))
table2.2 <- df_narrow %>%
filter(treatment == "pay-comm") %>%
group_by(round, treatment) %>%
summarise(y = mean(investment))
table2.3 <- df_narrow %>%
filter(treatment == "message") %>%
group_by(round, treatment) %>%
summarise(y = mean(investment))
table2 <- rbind(table2.1, table2.2)
table2 <- rbind(table2, table2.3)
fig2 <- ggplot(table2, aes(round, y, group = treatment)) + geom_line(color = "grey") + geom_point(alpha = 0.75, aes(shape = treatment))
fig2
pic2 <- df_narrow %>%
select(treatment, round, investment) %>%
filter(treatment == c("individuals", "pay-comm", "message")) %>%
group_by(treatment, round) %>%
summarise(y = mean(investment, na.rm = TRUE)) %>%
ggplot(., aes(round, y)) +
geom_line(aes(group = treatment), color = "grey") +
geom_point(alpha=0.75, aes(shape = treatment)) +
labs(size = "Round") +
theme_classic()
pic2
fig3 <- df_narrow %>%
select(treatment, round, investment) %>%
filter(treatment == c("individuals", "mixed")) %>%
group_by(round, treatment) %>%
summarise(y = mean(investment)) %>%
ggplot(., aes(round, y)) +
geom_line(aes(group = treatment), color = "grey") +
geom_point(alpha=0.75, aes(shape = treatment)) +
labs(size = "Round") +
theme_classic()
fig3
rm(table1, table2.1, table2.2, table2.3, table2, table3)
plot_grid(fig1, fig2, fig3,
labels = c('a', 'b', 'c'),
nrow = 1)
df_team_avg <- df_narrow %>%
group_by(treatment, uniqueteam) %>%
summarise(mean(investment))
# should be get 99 rows
df_narrow %>%
group_by(uniqueteam) %>%
summarise(mean(investment))
ppl <- df_team_avg$`mean(investment)`[which(df_team_avg == "individuals")]
team <- df_team_avg$`mean(investment)`[which(df_team_avg == "teams")]
wilcox.test(ppl, team, var.equal=F, paired = F)
pay <- df_team_avg$`mean(investment)`[which(df_team_avg == "pay-comm")]
mes <- df_team_avg$`mean(investment)`[which(df_team_avg == "message")]
wilcox.test(ppl, pay, var.equal = F, paired = F)
wilcox.test(pay, mes, var.equal = F, paired = F)   # 0.06903
wilcox.test(team, mes, var.equal = F, paired = F)
wilcox.test(team, pay, var.equal = F, paired = F)
df_narrow <- cbind(df_narrow, dummy(df_narrow$treatment, sep = "_"))
View(df_narrow)
#m <- lm(investment ~ df_narrow_teams+"df_narrow_pay-comm"+df_narrow_message+df_narrow_mixed, data = df_narrow)
m <- lm(investment ~ treatment, data = df_narrow)
summary(m)
lmtest::coeftest(m, vcov_subjectid)
vcov_subjectid <- sandwich::vcovCL(m, cluster = df_narrow$uniquesubject)
lmtest::coeftest(m, vcov_subjectid)
rm(list = ls()) # Clear environment
library(tidyverse)
library(tidyverse)
library(cowplot)
library(sandwich)
library(lmtest)
df <- read_csv("sutterexperiment.csv")
old.names <- colnames(df)
new.names <- tolower(old.names)
colnames(df) <- new.names
rm(new.names, old.names)
df$treatment <- tolower(df$treatment)
df <- df %>%
mutate(uniquesubject = paste(session, treatment, subject, sep = "_"))
df <- df %>%
mutate(uniqueteam = paste(session, team, sep = "_"))
df <- df %>% mutate(uniqueteam = ifelse(treatment == "individuals", uniquesubject, uniqueteam))
df_narrow <- df %>%
gather("round", "investment", -c(session, subject, treatment, team, uniquesubject, uniqueteam)) %>%
arrange(session, subject, treatment, team)
#df_narrow <- read_csv("sutterexperiment_long.csv")
df_narrow$round <- gsub("r", "", df_narrow$round)
df_narrow %>%
group_by(treatment) %>%
select(investment) %>%
summarise_all(funs(mean, sd))
df_narrow %>%
group_by(treatment) %>%
ggplot(., aes(treatment, investment)) +
stat_summary(fun.y = mean, geom = "bar", fill="grey") +
stat_summary(fun.data = mean_se, geom = "errorbar", width=0.1) +
labs(y = "mean and standard error", x = "Treatment", title = "Mean and Error Bars of Each Treatment") +
theme_classic()
rm(list = ls()) # Clear environment
library(tidyverse)
library(cowplot)
library(sandwich)
library(lmtest)
df <- read_csv("sutterexperiment.csv")
old.names <- colnames(df)
new.names <- tolower(old.names)
colnames(df) <- new.names
rm(new.names, old.names)
df$treatment <- tolower(df$treatment)
df <- df %>%
mutate(uniquesubject = paste(session, treatment, subject, sep = "_"))
df <- df %>%
mutate(uniqueteam = paste(session, team, sep = "_"))
df <- df %>% mutate(uniqueteam = ifelse(treatment == "individuals", uniquesubject, uniqueteam))
df_narrow <- df %>%
gather("round", "investment", -c(session, subject, treatment, team, uniquesubject, uniqueteam)) %>%
arrange(session, subject, treatment, team)
# df %>% gather("key", "value", x, y, z) is equivalent to df %>% pivot_longer(c(x, y, z), names_to = "key", values_to = "value")
#df_narrow <- read_csv("sutterexperiment_long.csv")
df_narrow$round <- gsub("r", "", df_narrow$round)
df_narrow %>%
group_by(treatment) %>%
select(investment) %>%
summarise_all(funs(mean, sd))
df_narrow %>%
group_by(treatment) %>%
ggplot(., aes(treatment, investment)) +
stat_summary(fun.y = mean, geom = "bar", fill="grey") +
stat_summary(fun.data = mean_se, geom = "errorbar", width=0.1) +
labs(y = "mean and standard error", x = "Treatment", title = "Mean and Error Bars of Each Treatment") +
theme_classic()
#table1 <- df_narrow %>%  filter(treatment == c("individuals", "teams"))%>%  group_by(round, treatment) %>%  summarise(y = mean(investment))
#fig1 <- ggplot(table1, aes(round, y, group = treatment)) + geom_line(color = "grey") + geom_point(alpha = 0.75, aes(shape = treatment))
fig1 <- df_narrow %>%
select(treatment, round, investment) %>%
filter(treatment == c("individuals", "teams")) %>%
group_by(round, treatment) %>%
summarise(y = mean(investment)) %>%
ggplot(., aes(round, y)) +
geom_line(aes(group = treatment), color = "grey") +
geom_point(alpha=0.75, aes(shape = treatment)) +
labs(size = "Round") +
theme_classic()
fig1
table2.1 <- df_narrow %>%
filter(treatment == "individuals") %>%
group_by(round, treatment) %>%
summarise(y = mean(investment))
table2.2 <- df_narrow %>%
filter(treatment == "pay-comm") %>%
group_by(round, treatment) %>%
summarise(y = mean(investment))
table2.3 <- df_narrow %>%
filter(treatment == "message") %>%
group_by(round, treatment) %>%
summarise(y = mean(investment))
table2 <- rbind(table2.1, table2.2)
table2 <- rbind(table2, table2.3)
fig2 <- ggplot(table2, aes(round, y, group = treatment)) + geom_line(color = "grey") + geom_point(alpha = 0.75, aes(shape = treatment))
fig2
pic2 <- df_narrow %>%
select(treatment, round, investment) %>%
filter(treatment == c("individuals", "pay-comm", "message")) %>%
group_by(treatment, round) %>%
summarise(y = mean(investment, na.rm = TRUE)) %>%
ggplot(., aes(round, y)) +
geom_line(aes(group = treatment), color = "grey") +
geom_point(alpha=0.75, aes(shape = treatment)) +
labs(size = "Round") +
theme_classic()
pic2
fig3 <- df_narrow %>%
select(treatment, round, investment) %>%
filter(treatment == c("individuals", "mixed")) %>%
group_by(round, treatment) %>%
summarise(y = mean(investment)) %>%
ggplot(., aes(round, y)) +
geom_line(aes(group = treatment), color = "grey") +
geom_point(alpha=0.75, aes(shape = treatment)) +
labs(size = "Round") +
theme_classic()
fig3
rm(table1, table2.1, table2.2, table2.3, table2, table3)
plot_grid(fig1, fig2, fig3,
labels = c('a', 'b', 'c'),
nrow = 1)
df_team_avg <- df_narrow %>%
group_by(treatment, uniqueteam) %>%
summarise(mean(investment))
# should be get 99 rows
df_narrow %>%
group_by(uniqueteam) %>%
summarise(mean(investment))
ppl <- df_team_avg$`mean(investment)`[which(df_team_avg == "individuals")]
team <- df_team_avg$`mean(investment)`[which(df_team_avg == "teams")]
wilcox.test(ppl, team, var.equal=F, paired = F)
pay <- df_team_avg$`mean(investment)`[which(df_team_avg == "pay-comm")]
mes <- df_team_avg$`mean(investment)`[which(df_team_avg == "message")]
wilcox.test(ppl, pay, var.equal = F, paired = F)
wilcox.test(pay, mes, var.equal = F, paired = F)   # 0.06903
wilcox.test(team, mes, var.equal = F, paired = F)
wilcox.test(team, pay, var.equal = F, paired = F)
#df_narrow <- cbind(df_narrow, dummy(df_narrow$treatment, sep = "_"))
m <- lm(investment ~ treatment, data = df_narrow)
summary(m)
vcov_subjectid <- sandwich::vcovCL(m, cluster = df_narrow$uniquesubject)
lmtest::coeftest(m, vcov_subjectid)
pic2 <- df_narrow %>%
select(treatment, round, investment) %>%
filter(treatment == c("individuals" or "pay-comm" or "message")) %>%
fig2
fig2
knitr::opts_chunk$set(echo = TRUE)
# a.
tute1 <- read.csv("/Users/apple/Desktop/bc_f19_econ/Forecasting/Probset1_files/tute1.csv", header = TRUE)
